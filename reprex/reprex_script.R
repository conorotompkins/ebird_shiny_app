library(tidyverse)
library(sf)

mollweide <- "+proj=moll +lon_0=-90 +x_0=0 +y_0=0 +ellps=WGS84"

# read_csv("reprex/coords.csv") %>% 
#   as_tibble() %>% 
#   dput()

coords <- structure(list(x = c(794090.315618213, 794090.315618213, 820790.315618213, 
                               820790.315618213, 820790.315618213, 820790.315618213, 820790.315618213, 
                               820790.315618213, 820790.315618213, 820790.315618213, 820790.315618213, 
                               820790.315618213, 847490.315618213, 847490.315618213, 847490.315618213, 
                               847490.315618213, 847490.315618213, 847490.315618213, 847490.315618213, 
                               847490.315618213, 847490.315618213, 847490.315618213, 847490.315618213, 
                               874190.315618213, 874190.315618213, 874190.315618213, 874190.315618213, 
                               874190.315618213, 874190.315618213, 874190.315618213, 874190.315618213, 
                               874190.315618213, 874190.315618213, 900890.315618213, 900890.315618213, 
                               900890.315618213, 900890.315618213, 900890.315618213, 900890.315618213, 
                               900890.315618213, 900890.315618213, 900890.315618213, 900890.315618213, 
                               927590.315618213, 927590.315618213, 927590.315618213, 927590.315618213, 
                               927590.315618213, 927590.315618213, 927590.315618213, 927590.315618213, 
                               927590.315618213, 927590.315618213, 954290.315618213, 954290.315618213, 
                               954290.315618213, 954290.315618213, 954290.315618213, 954290.315618213, 
                               954290.315618213, 954290.315618213, 954290.315618213, 954290.315618213, 
                               980990.315618213, 980990.315618213, 980990.315618213, 980990.315618213, 
                               980990.315618213, 980990.315618213, 980990.315618213, 980990.315618213, 
                               980990.315618213, 980990.315618213, 1007690.31561821, 1007690.31561821, 
                               1007690.31561821, 1007690.31561821, 1007690.31561821, 1007690.31561821, 
                               1007690.31561821, 1007690.31561821, 1007690.31561821, 1007690.31561821, 
                               1034390.31561821, 1034390.31561821, 1034390.31561821, 1034390.31561821, 
                               1034390.31561821, 1034390.31561821, 1034390.31561821, 1034390.31561821, 
                               1034390.31561821, 1034390.31561821, 1061090.31561821, 1061090.31561821, 
                               1061090.31561821, 1061090.31561821, 1061090.31561821, 1061090.31561821, 
                               1061090.31561821, 1061090.31561821, 1061090.31561821, 1061090.31561821, 
                               1087790.31561821, 1087790.31561821, 1087790.31561821, 1087790.31561821, 
                               1087790.31561821, 1087790.31561821, 1087790.31561821, 1087790.31561821, 
                               1087790.31561821, 1087790.31561821, 1114490.31561821, 1114490.31561821, 
                               1114490.31561821, 1114490.31561821, 1114490.31561821, 1114490.31561821, 
                               1114490.31561821, 1114490.31561821, 1114490.31561821, 1114490.31561821, 
                               1141190.31561821, 1141190.31561821, 1141190.31561821, 1141190.31561821, 
                               1141190.31561821, 1141190.31561821, 1141190.31561821, 1141190.31561821, 
                               1141190.31561821, 1141190.31561821, 1167890.31561821, 1167890.31561821, 
                               1167890.31561821, 1167890.31561821, 1167890.31561821, 1167890.31561821, 
                               1167890.31561821, 1167890.31561821, 1167890.31561821, 1167890.31561821, 
                               1194590.31561821, 1194590.31561821, 1194590.31561821, 1194590.31561821, 
                               1194590.31561821, 1194590.31561821, 1194590.31561821, 1194590.31561821, 
                               1194590.31561821, 1194590.31561821, 1221290.31561821, 1221290.31561821, 
                               1221290.31561821, 1221290.31561821, 1221290.31561821, 1221290.31561821, 
                               1221290.31561821, 1221290.31561821, 1221290.31561821, 1247990.31561821, 
                               1247990.31561821, 1247990.31561821, 1247990.31561821, 1247990.31561821, 
                               1247990.31561821, 1247990.31561821, 1247990.31561821, 1247990.31561821, 
                               1247990.31561821, 1274690.31561821, 1274690.31561821, 1274690.31561821, 
                               1274690.31561821, 1274690.31561821, 1274690.31561821, 1274690.31561821, 
                               1274690.31561821, 1274690.31561821, 1301390.31561821, 1301390.31561821, 
                               1301390.31561821, 1301390.31561821, 1301390.31561821, 1301390.31561821, 
                               1301390.31561821, 1301390.31561821, 1301390.31561821, 1301390.31561821, 
                               1328090.31561821, 1328090.31561821, 1328090.31561821, 1328090.31561821, 
                               1328090.31561821, 1328090.31561821, 1328090.31561821, 1354790.31561821
), y = c(4975708.24422306, 5002408.24422306, 4762108.24422306, 
         4788808.24422306, 4815508.24422306, 4842208.24422306, 4868908.24422306, 
         4895608.24422306, 4922308.24422306, 4949008.24422306, 4975708.24422306, 
         5002408.24422306, 4762108.24422306, 4788808.24422306, 4815508.24422306, 
         4842208.24422306, 4868908.24422306, 4895608.24422306, 4922308.24422306, 
         4949008.24422306, 4975708.24422306, 5002408.24422306, 5029108.24422306, 
         4762108.24422306, 4788808.24422306, 4815508.24422306, 4842208.24422306, 
         4868908.24422306, 4895608.24422306, 4922308.24422306, 4949008.24422306, 
         4975708.24422306, 5002408.24422306, 4762108.24422306, 4788808.24422306, 
         4815508.24422306, 4842208.24422306, 4868908.24422306, 4895608.24422306, 
         4922308.24422306, 4949008.24422306, 4975708.24422306, 5002408.24422306, 
         4762108.24422306, 4788808.24422306, 4815508.24422306, 4842208.24422306, 
         4868908.24422306, 4895608.24422306, 4922308.24422306, 4949008.24422306, 
         4975708.24422306, 5002408.24422306, 4762108.24422306, 4788808.24422306, 
         4815508.24422306, 4842208.24422306, 4868908.24422306, 4895608.24422306, 
         4922308.24422306, 4949008.24422306, 4975708.24422306, 5002408.24422306, 
         4762108.24422306, 4788808.24422306, 4815508.24422306, 4842208.24422306, 
         4868908.24422306, 4895608.24422306, 4922308.24422306, 4949008.24422306, 
         4975708.24422306, 5002408.24422306, 4762108.24422306, 4788808.24422306, 
         4815508.24422306, 4842208.24422306, 4868908.24422306, 4895608.24422306, 
         4922308.24422306, 4949008.24422306, 4975708.24422306, 5002408.24422306, 
         4762108.24422306, 4788808.24422306, 4815508.24422306, 4842208.24422306, 
         4868908.24422306, 4895608.24422306, 4922308.24422306, 4949008.24422306, 
         4975708.24422306, 5002408.24422306, 4762108.24422306, 4788808.24422306, 
         4815508.24422306, 4842208.24422306, 4868908.24422306, 4895608.24422306, 
         4922308.24422306, 4949008.24422306, 4975708.24422306, 5002408.24422306, 
         4762108.24422306, 4788808.24422306, 4815508.24422306, 4842208.24422306, 
         4868908.24422306, 4895608.24422306, 4922308.24422306, 4949008.24422306, 
         4975708.24422306, 5002408.24422306, 4762108.24422306, 4788808.24422306, 
         4815508.24422306, 4842208.24422306, 4868908.24422306, 4895608.24422306, 
         4922308.24422306, 4949008.24422306, 4975708.24422306, 5002408.24422306, 
         4762108.24422306, 4788808.24422306, 4815508.24422306, 4842208.24422306, 
         4868908.24422306, 4895608.24422306, 4922308.24422306, 4949008.24422306, 
         4975708.24422306, 5002408.24422306, 4762108.24422306, 4788808.24422306, 
         4815508.24422306, 4842208.24422306, 4868908.24422306, 4895608.24422306, 
         4922308.24422306, 4949008.24422306, 4975708.24422306, 5002408.24422306, 
         4762108.24422306, 4788808.24422306, 4815508.24422306, 4842208.24422306, 
         4868908.24422306, 4895608.24422306, 4922308.24422306, 4949008.24422306, 
         4975708.24422306, 5002408.24422306, 4788808.24422306, 4815508.24422306, 
         4842208.24422306, 4868908.24422306, 4895608.24422306, 4922308.24422306, 
         4949008.24422306, 4975708.24422306, 5002408.24422306, 4735408.24422306, 
         4762108.24422306, 4788808.24422306, 4815508.24422306, 4842208.24422306, 
         4868908.24422306, 4895608.24422306, 4922308.24422306, 4949008.24422306, 
         4975708.24422306, 4708708.24422306, 4735408.24422306, 4762108.24422306, 
         4788808.24422306, 4815508.24422306, 4842208.24422306, 4868908.24422306, 
         4895608.24422306, 4922308.24422306, 4682008.24422306, 4708708.24422306, 
         4735408.24422306, 4762108.24422306, 4788808.24422306, 4815508.24422306, 
         4842208.24422306, 4868908.24422306, 4895608.24422306, 4922308.24422306, 
         4735408.24422306, 4762108.24422306, 4788808.24422306, 4815508.24422306, 
         4842208.24422306, 4868908.24422306, 4895608.24422306, 4815508.24422306
)), class = c("tbl_df", "tbl", "data.frame"), row.names = c(NA, 
                                                            -199L))
#current output
coords %>% 
  sf::st_as_sf(coords = c("x", "y"), crs = mollweide) %>% 
  ggplot() +
  geom_sf()

#preferably polygons will look like this
coords %>% 
  ggplot(aes(x, y)) +
  geom_tile(fill = "white", color = "black")


sfd <- coords %>% 
  sf::st_as_sf(coords = c("x", "y"), crs = mollweide)

bbox = st_bbox(sfd) %>% st_as_sfc() %>% st_buffer(26700/2)
grid = bbox %>% 
  st_make_grid(n=c(22, 14))

grid_geo <- bbox %>% 
  st_make_grid(n=c(22, 14))

grid = grid[sfd] 


grid %>% 
  st_sf() %>% 
  ggplot() +
  geom_sf() +
  geom_point(data = coords,
             aes(x, y))

source("scripts/functions/recreate_tile.R")

coords %>% 
  recreate_tile() %>% 
  bind_cols(coords) %>% 
  ggplot() +
  geom_sf() +
  geom_point(aes(x, y))



